<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tri Shell - Animation</title>
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: sans-serif; background: #0f172a; color: #e2e8f0; padding: 20px; min-height: 100vh; }
    .container { max-width: 1200px; margin: 0 auto; }
    h1 { text-align: center; margin: 20px 0; color: #f1f5f9; }
    
    /* Panneau de contrôle */
    .control-panel { background: #1e293b; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
    .buttons { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
    button { padding: 12px 24px; border: none; border-radius: 8px; color: white; cursor: pointer; }
    #startBtn { background: #3b82f6; }
    #generateBtn { background: #10b981; }
    #speedBtn { background: #8b5cf6; }
    button:disabled { background: #475569; cursor: not-allowed; }
    
    /* Affichage tableau */
    .array-display { background: #1e293b; padding: 30px; border-radius: 10px; margin: 20px 0; }
    .array-container { display: flex; gap: 10px; align-items: flex-end; justify-content: center; }
    .array-element {
        width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;
        border-radius: 8px; font-weight: bold; color: white; transition: all 0.3s;
    }
    .default { background: #475569; }
    .comparing { background: #f59e0b; transform: scale(1.1); }
    .swapping { background: #ef4444; animation: pulse 1s infinite; }
    .current-gap { background: #8b5cf6; }
    .sorted { background: #10b981; }
    @keyframes pulse { 
        0%,100% { transform: scale(1.1); } 
        50% { transform: scale(1.2); } 
    }
    
    /* État et code */
    #steps { background: #1e293b; padding: 20px; border-radius: 10px; margin: 20px 0; }
    .status-info { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; margin: 20px 0; }
    .info-item { background: #0f172a; padding: 15px; border-radius: 8px; text-align: center; }
    .code-block { background: #0f172a; padding: 20px; border-radius: 10px; margin: 20px 0; }
    pre { color: #e2e8f0; overflow-x: auto; }
    
    /* Watermark */
    .watermark {
        position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%);
        background: #1e293b; color: white; padding: 12px 25px; border-radius: 8px;
        text-align: center; border: 2px solid #10b981;
    }
    
    @media (max-width: 768px) {
        .array-element { width: 45px; height: 45px; }
        button { padding: 10px 20px; font-size: 14px; }
    }
</style>
</head>
<body>
<div class="container">
    <h1>Tri Shell (Shell Sort)</h1>
    
    <!-- Contrôles -->
    <div class="control-panel">
        <div class="buttons">
            <button id="startBtn">Démarrer</button>
            <button id="generateBtn">Nouveau Tableau</button>
            <button id="speedBtn">Vitesse: ×1</button>
        </div>
    </div>
    
    <!-- Tableau animé -->
    <div class="array-display">
        <div class="array-container" id="arrayContainer"></div>
    </div>
    
    <!-- Description étapes -->
    <div id="steps">Prêt à commencer...</div>
    
    <!-- Statistiques -->
    <div class="status-info">
        <div class="info-item"><div>Pas actuel</div><div id="currentGap">-</div></div>
        <div class="info-item"><div>Comparaisons</div><div id="comparisons">0</div></div>
        <div class="info-item"><div>Décalages</div><div id="shifts">0</div></div>
    </div>
    
    <!-- Algorithme -->
    <div class="code-block">
        <h3>Algorithme du Tri Shell</h3>
        <pre>procédure tri_shell(@T:tab; N:entier)
Début
    p ← 0
    Tant que (p < N) faire
        p ← 3 × p + 1
    Fin Tant que
    
    Tant que (p ≠ 0) faire
        p ← p div 3
        Pour i de p à N-1 faire
            v ← T[i]
            j ← i
            Tant que (j ≥ p) et (T[j-p] > v) faire
                T[j] ← T[j-p]
                j ← j - p
            Fin Tant que
            T[j] ← v
        Fin Pour
    Fin Tant que
Fin</pre>
    </div>
</div>

<div class="watermark">
    Créé par Amine | GitHub: <a href="https://github.com/AmineTNYT" target="_blank" style="color:#10b981;">@AmineTNYT</a>
</div>

<script>
// Éléments DOM
const arrayContainer = document.getElementById('arrayContainer');
const startBtn = document.getElementById('startBtn');
const generateBtn = document.getElementById('generateBtn');
const speedBtn = document.getElementById('speedBtn');
const stepsDiv = document.getElementById('steps');
const currentGap = document.getElementById('currentGap');
const comparisons = document.getElementById('comparisons');
const shifts = document.getElementById('shifts');

// Variables globales
let arr = [];
let isAnimating = false;
let speedLevel = 1;
let baseDelay = 1000;

// Gestion vitesse
speedBtn.onclick = () => {
    if (speedLevel === 1) { speedLevel = 2; baseDelay = 500; speedBtn.textContent = "Vitesse: ×2"; }
    else if (speedLevel === 2) { speedLevel = 4; baseDelay = 250; speedBtn.textContent = "Vitesse: ×4"; }
    else { speedLevel = 1; baseDelay = 1000; speedBtn.textContent = "Vitesse: ×1"; }
};

// Fonction pause
function sleep(ms) { return new Promise(resolve => setTimeout(resolve, ms / speedLevel)); }

// Initialisation tableau
function initializeArray() {
    arr = [35, 33, 42, 10, 14, 19, 27, 44, 26, 31];
    renderArray();
    resetStats();
    stepsDiv.textContent = "Cliquez sur 'Démarrer' pour lancer l'animation.";
}

// Génération aléatoire
function generateRandomArray() {
    arr = Array.from({length: 10}, () => Math.floor(Math.random() * 90) + 10);
    renderArray();
    resetStats();
    stepsDiv.textContent = "Nouveau tableau généré. Cliquez sur 'Démarrer'.";
}

// Affichage tableau
function renderArray() {
    arrayContainer.innerHTML = '';
    arr.forEach((val, i) => {
        const div = document.createElement('div');
        div.className = 'array-element default';
        div.id = `elem${i}`;
        div.textContent = val;
        arrayContainer.appendChild(div);
    });
}

// Réinitialisation stats
function resetStats() {
    currentGap.textContent = '-';
    comparisons.textContent = '0';
    shifts.textContent = '0';
}

// Mise à jour élément
function updateElement(index, className) {
    const elem = document.getElementById(`elem${index}`);
    elem.className = `array-element ${className}`;
}

// Tri Shell animé
async function shellSortAnimation() {
    if (isAnimating) return;
    isAnimating = true;
    startBtn.disabled = true;
    generateBtn.disabled = true;
    
    const n = arr.length;
    let totalComparisons = 0;
    let totalShifts = 0;
    
    // Calcul séquence des pas (Knuth)
    let gap = 1;
    while (gap < n) gap = gap * 3 + 1;
    gap = Math.floor(gap / 3);
    
    while (gap > 0) {
        currentGap.textContent = gap;
        stepsDiv.textContent = `Pas = ${gap} - Tri par insertion avec ce décalage`;
        await sleep(2000);
        
        for (let i = gap; i < n; i++) {
            const temp = arr[i];
            let j = i;
            
            // Affichage comparaison
            updateElement(i, 'comparing');
            if (j - gap >= 0) updateElement(j - gap, 'comparing');
            totalComparisons++;
            comparisons.textContent = totalComparisons;
            await sleep(1500);
            
            // Décalage éléments
            while (j >= gap && arr[j - gap] > temp) {
                arr[j] = arr[j - gap];
                document.getElementById(`elem${j}`).textContent = arr[j];
                
                updateElement(j - gap, 'swapping');
                updateElement(j, 'swapping');
                totalShifts++;
                shifts.textContent = totalShifts;
                
                await sleep(1500);
                
                // Réinitialisation couleurs
                updateElement(j - gap, 'default');
                updateElement(j, 'default');
                
                j -= gap;
            }
            
            // Insertion valeur
            if (j !== i) {
                arr[j] = temp;
                document.getElementById(`elem${j}`).textContent = temp;
                updateElement(j, 'swapping');
                await sleep(1500);
            }
            
            // Réinitialisation
            for (let k = 0; k < n; k++) {
                updateElement(k, k <= i ? 'sorted' : 'default');
            }
        }
        
        gap = Math.floor(gap / 3);
    }
    
    // Finalisation
    for (let i = 0; i < n; i++) updateElement(i, 'sorted');
    stepsDiv.textContent = `Tri terminé! ${totalComparisons} comparaisons, ${totalShifts} décalages`;
    
    isAnimating = false;
    startBtn.disabled = false;
    generateBtn.disabled = false;
}

// Événements
generateBtn.onclick = generateRandomArray;
startBtn.onclick = shellSortAnimation;

// Initialisation
initializeArray();
</script>
</body>
</html>
